<!DOCTYPE html PUBLIC "-W3CDTD XHTML 1.0 StrictEN"
	"http:www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http:www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<title>Text and Image Linking Environment Docs</title>
</head>


<body>
<h1>Documentation for TILE Interface</h1>	
<h1>lib/</h1>
<h2>ActiveBox.js</h2>
<h4>ActiveBox</h4>
<p>Constructor: ActiveBox({loc: {String}, html: {String}})</p>
<p>Arguments:<br/>
	<pre>
		<strong>loc</strong> - String representing ID of parent DOM<br/>
		<strong>html</strong> - String representing HTML that's taken from JSON in TILE ENGINE
	</pre>
	</p>
<p><pre>
	_addItem(data {Object}) - Loads a JSON object (data) into the ActiveBox - can be any JSON object.<br/>
	getObjData(obj {Object}) - Recursively goes through a sub-JSON object. Used in _addItem
	clearArea - Clears the active Box area from previous HTML content
</pre></p>

<h2>tile1.0.js</h2>	

<h3>TILE Interface</h3>
<p>Base objects for plugins, sets up the HTML layout for the page. Creates Transcript and ActiveBox objects and handles<br/>
	any tool plugins fed from the toolSets parameter.
	</p>

<h4>Image</h4>
<p>Constructor: Image({url: {String}})</p>
<p><pre>
	getZoomLevel - Returns a copy of the current zoom level {Integer}<br/>
	activate - Shows the container DOM <br/>
	deactivate - Hide the container DOM<br/>
</pre></p>

<h4>SideToolBar</h4>
<p>Constructor: SideToolBar({loc: {String}})</p>
<p><pre>
	activate - Shows the container DOM<br/>
	deactivate - Hides the container DOM
</pre></p>

<h4>Dialog</h4>
<p>Constructor: Dialog({loc: {String}, html: {String}})</p>
<p>**These arguments are used for all Dialog Objects <br/><pre>
	loc - {String} representing ID of parent DOM - defaults to 'body'<br/>
	html - {String} HTML in string format for this Dialog box
</pre><p>

<h4>Import Dialog</h4>
<p>Constructor: ImportDialog({loc: {String}, html: {String}, auto: {String}})</p>
<p>**Arguments same as Dialog except: <br/><pre>
	auto - {String} What to put as default in the "File input" area
	</pre></p>
	<p><pre>
	display({e: {Event}) - Displays the container DOM<br/>
	close({e: {Event}}) - Hides the container DOM<br/>
	handleMultiForm(e: {Event}) - finds the transcript/image file that the user <br/>
	 					has input and sends it off in a CustomEvent trigger<br/>
						schemaFileImported<br/>
	
</pre></p>

<h4>LoadTags</h4>
<p>Constructor: LoadTags({loc: {String}, html: {String}})</p>
<p>**Arguments same as Dialog<pre>
	
	</pre></p>
	<p><pre>
	display({e: {Event}) - Displays the container DOM<br/>
	close({e: {Event}}) - Hides the container DOM<br/>	
</pre></p>

<h4>ExportDialog</h4>
<p>Constructor: LoadTags({loc: {String}, html: {String}})</p>
<p>**Arguments same as Dialog<pre>
	
	</pre></p>
	<p><pre>
	display({e: {Event}) - Displays the container DOM<br/>
	close({e: {Event}}) - Hides the container DOM<br/>
	_submitHandle(e: {Event}) - Takes the user-defined filepath in ExportDialog and <br/>
								uses it to output current JSON session as XML
</pre></p>
<h4>NewImageDialog</h4>
<p>Constructor: LoadTags({loc: {String}, html: {String}})</p>
<p>**Arguments same as Dialog<pre>
	
	</pre></p>
	<p><pre>
	display({e: {Event}) - Displays the container DOM<br/>
	close({e: {Event}}) - Hides the container DOM<br/>
	handleImageForm(e: {Event}) - Takes file input path and sends it out using trigger<br/>
								"newImageAdded"
	
</pre></p>

<h4>TILE_ENGINE</h4>

<p>Constructor: TILE_ENGINE({attach:(optional){String},toolSet:{Array}})</p>
<p>Arguments: <br/>
	<strong>attach</strong> - {String} what to attach the interface to (defaults to "body")<br/>
	<strong>toolSet</strong> - {Array} Array of plugin objects that are fed into the TILE_ENGINE to be used as plugins<br/>
				These are displayed in the "Tools" drop-down
</p>
<p><pre>
Loads in HTML layout from columns.json, parses JSON and sends to all <br/>
 other objects.<br/>
 <br/>
 <strong>Functions</strong><br/>
 	getBase - Calls TILECONSTANTS.json file and gets base, possible json data<br/>
	checkJSON - Called to see if there is a JSON object stored in the PHP session() <br/>
 	setUp({Object} html) - Called after getBase(). Creates main TILE interface objects and<br/>
			setting up the HTML<br/>
 	getSchema({Event} e, {String} file) - Called from Custom Event "schemaFileImport". Passed a string 'file', which <br/>
				is then used in an AJAX call to retrieve the JSON data. JSON data should follow TILE specifications and include<br/>
				all relevant page data, lines, and optionally stored shapes<br/>
	addDialogBoxes - called during setUp(). Takes dialogs.json data and loads this into the interface. Sets up New Image Dialog,<br/>
					 Export Dialog, Load Dialog, Save Dialog<br/>
	_newPageHandle({Event} e, {String} url) -  Called by Custom Event "newPageLoaded". If a url is passed, it will set a new 
						manifest record for that url and change the transcript lines in the transcript line area. 
	_toolDoneHandle({Event} e) - Called by a tool's 'done' Event. Triggers the interface to load the default plugin tool.<br/>
	_toolOutputHandle({Event} e, {Object} data) - Called by a tool's 'output' event. Passes JSON object @data to the Transcript object<br/>
	_transcriptSelectHandle({Event} e, {Object} data) - called by "TranscriptLineSelected" Event. Passes the @data parameter as JSON data to the<br/>
														ActiveBox object.
	setUpTool({String} toolname) - sets a new tool - users must define tool in .js code and proper JSON format<br/>
 	saveSettingsHandle({Event} e) - Called by "SaveAllSettings" Event. Starts prompt to save the current manifest of data as a JSON object<br/>
 	

</pre></p>			

<h4>TileToolBar</h4>
<p>Constructor: TileToolBar({loc:{String}})</p>
<p><pre>Arguments:<br/>
	loc {String} - Represents ID of parent DOM
	
	</pre></p>
<p><pre>
	setChoices(data: {Object}) - Populates the Tools select menu. Takes JSON object data and sets each <br/>
								option tag to the name of the particular tool.
	setChoice(name: {String}) - When a user selects a tool, jQuery doesn't change the .selected property on <br/>
								that option tag. So this does this manually. Sets option with 'name' as the <br/>
								selected option tag.
</pre></p>


<h2>Transcript.js</h2>				
<h4>Transcript</h4>
<p>Constructor: Transcript({loc:{String}})</p><br/>
Arguments:<br/>
	loc: {String} what to attach this Object's DOM to (Includes ul list of transcript lines and buttons)
<p><pre>
	 _drawText : displays the text that is contained in the lineArray variable<br/>
	 _addLines(data,{optional} url) : takes a JSON-based array (data) and optional parameter url (if this data belongs<br/>
	 	to a new image) and changes the text display<br/>
	 _shapeDrawnHandle : handler for the VectorDrawer shapeDrawn event. adds the drawn shape to the currently selected line<br/>
	 _deleteItemHandle : handler for the deleteItem event from ActiveBox<br/>
	 _updateItemHandle : handler for the shapeChanged event from VectorDrawer<br/>
	 _lineSelected(index) : takes the argument index and sets the current line to the lineArray index matching index<br/>
	 _lineDeSelected(index) : the opposite of _lineSelected<br/>
	 exportLines : returns the lineArray<br/>
	 bundleData(manifest) : takes argument manifest, which is the manifest for TILE_ENGINE, modifies/updates the TILE_ENGINE<br/>
	 							manifest data, then sends modified manifest back.
</pre></p>
<h2>image_tagger.js</h2>
<h3>Image Tagger</h3>
<p>This is a TILE plugin. It functions with the TILE Interface through the IT object<br/>
	provided in the code. The IT object has a series of functions and properties that <br/>
	the TILE interface looks for. To create a custom plugin, see the Create Custom Plugin <br/>
	Tutorial.</p>

<h4>_Itag</h4>
<p></p>
<p><pre>Usage:
	new _Itag({loc: {String}, base: {String}, json: {Object}})
	
	loc {String} - represents ID of parent DOM
	base {String} - represents path to images
	json {Object} - JSON object of all image data (pages, lines, shapes)
	</pre></p>
<p><pre>
	ingestImages(e: {Event},manifest: {Object}) - receives a JSON string that will be used 
				as a map of images and other data
	setHTML(html : {Object}) - Sets up the HTML for this object. Creates RaphaelImage
	createShapeToolBar(e : {Event}) - Called by VDCanvasDONE event. Creates the shape tool bar, after the
					VectorDrawer has completed construction and calls VDCanvasDONE.
	addNewImage(e : {Event}, path : {String}) - Called by newImageAdded event. Passed 'path', which is a string<br/>
						to a new image to be added to the internal manifest, and later to the output.
	switchHandler(e : {Event}, url : {String}) - Called by switchImage event. Passed a string 'url', which represents
						a url in the manifest.
	showImageList(e : {Event}) - called by showImageList event. Calls ImageList display() method.
	_restart - Function that restarts the _Itag element after it has been constructed. Used by the IT object when TILE_ENGINE
					calls the tool to appear after it's construction.
	_closeDown - Function called by IT object to hide the tool.
	bundleData - Function called by IT object to output data.
	
</pre></p>

<h4>ImageList</h4>
<p>Constructor: ImageList({})</p>
<p><pre>
	Usage:
		new ImageList({loc: {String}, html : {String}}) 
		
		loc {String} - ID of the parent DOM
		html {String} - HTML in string format for ImageList (found in imagetagger.json)
	
</pre></p>
<p><pre>
	show(data : {Object}) - takes JSON Object 'data' and populates the ImageList area with 
				image urls taken from data. Once called, sets click event for ImgList button
				to make ImageList hide from DOM.
</pre></p>

<h4>TILEShapeToolBar</h4>
<p>Constructor: TILEShapeToolBar({})</p>
<p><pre>
	Usage : 
	new TILEShapeToolBar({loc:{String}})
	
	loc: {String} - ID of parent DOM
</pre></p>
<p><pre>
	setUpColorPicker - Sets up and attaches necessary DOM elements for the jQuery ColorPicker
					plugin - used to select colors for shapes.
	customWidgetClick(e : {Event}) - Used for opening and closing ColorPicker. 
	closeWidgetClick(e : {Event}) - 
	onCPSubmit(hsb : {String},hex: {Integer},rgb : {String}) - After user selects a color in ColorPicker,
				this triggers the event NEWSHAPECOLOR and sends the hexidecimal value out.
	activateShapeBar(e : {Event}) - called either remotely ("ActivateShapeBar" event) or locally
				 sets all shape choices to inactive, then checks what the current shape
				 type is and activates that shape choice changes DOM styles
	deactivateShapeBar(e : {Event}) - called either remotely ("DeActivateShapeBar" event) or locally
				 sets all shape choices to inactive
	turnOffShapeBar(e : {Event}) - Sets all of the classes for tools and buttons in toolbar to 'inactive'. 
			Called by 'turnOffShapeBar' event.
</pre></p>

<h4>RaphaelImage</h4>
<p><pre>Usage:
	new RaphaelImage({loc: {String}, canvasAreaId: {String}});
	
	loc: {String} - Id for the parent DOM
	canvasAreaId: {String} - Id for the div that will contain the canvas
	</pre></p>
<p><pre>
	setNewManifest(manifest : {Object}) - takes JSON object manifest and sets this as the new 
						manifest for RaphaelImage. Manifests must have urls as keys to the array, 
						with each record in the array being a JSON object with 
						{info:{Object},lines:[{Object}...]}
	addUrl(url : {String}) - adds a url to the manifest file. Can be a single url or an array of Urls.
	closeDownCanvas - Called once the image tagger tool is being hidden. Flashes the canvas, then hides it.
	setUpCanvas(url: {String}) - Takes a string 'url' and sets the Raphael Canvas to this. Creates the VectorDrawer
			tool if not already constructed.
	setUpDrawTool - called only if VectorDrawer is not active. Sets up VectorDrawer and its event handlers
	_newColorHandle(e : {Event}, cp : {Integer}) - Called by NEWSHAPECOLOR event. Passed the integer cp, which represents
				the new hexidecimal color value, which is set in VectorDrawer
	closeSVGHandle(e : {Event}, s : {Boolean}) - When something is opened above the SVG canvas, the user can trigger the 
				'closeDownVD' and pass 'true' to 'turn off' the canvas. Pass 'false' to turn it back on.
				
	_loadShapesHandle(e : {Event}, json : {Object}) - Called by loadShapes event. Takes the JSON object json and loads the shapes
	 					inside it into the VectorDrawer.
	zoomHandle(e : {Event}, n : {Integer}) - Called by the 'zoom' event. Takes integer 'n' and scales the VectorDrawer and the canvas
				area accordingly.
	_restart - Called after the tool has been constructed, hidden, then called again. All hidden DOM elements are re-attached and 
			events re-bound
	showImg(e : {Event}, val : {Integer}) - Handles the turnPage event. Val is either 1 or -1. If 1, turns one page forward (if available), if -1,
				turns one page back (if available).
	goToPage(url : {String}) - Passed a url string that it finds in the 
					manifest and goes to that page.
	showCurrentImage(e : {Event}) - Called by the 'imageAdded' event. Takes whatever the current url in manifest is and displays
					this url.
	changeShapeType(e : {Event}, type : {String}) - Called by 'changeShapeType' event. Passed a 'type' (r,e,p,s) string which it feeds
					into the VectorDrawer
	bundleData - Returns the RaphaelImage manifest object
	
</pre></p>

<h4>IT</h4>
<p>No Constructor: This is a pre-defined object that is fed into <br/>
	the TILE interface to be used as a plugin.</p>
<p><pre>Properties:
	
	</pre></p>
<p><pre>Functions:</pre></p>


<h2>autorecognizer_plugin.js</h2>
<h3>Auto Recognizer</h3>
<h4>TileOCR</h4>
<p>Usage:<br/>
	var v = new TileOCR({loc:{String}})<br/>
	
	
	args.loc {String} - id for where toolbar is located<br/>
	args.transcript {Object} - JSON object containing lines for this url
	</p>
<p><pre>
	_setUp(e {Event},jsonhtml {Object}) -	Setting up the HTML for AutoRecognizer<br/>
	 		Called by 'autoRecJSONReady' trigger<br/>
	 		Replaces both the Transcript and ActiveBox areas to the left and <br/>
	 		replaces canvas area<br/>
	 		
	 			jsonhtml : {Object} JSON object containing strings for <br/>
					autorecognizer HTML elements <br/>
	swapCanvas - Sets up HTML for the Canvas area
	_restart(transcript {Object}) - Restarts the TILEOCR object - fed transcript JSON
				object for transcript lines
	_loadTranscript - takes the transcript object loaded at construction, then places lines
				into the transcript area.
	ColorChangeHandle(e {Event},thresh {Integer}) - Called by drag and resize event triggers. Calls
					the CanvasAutoRecognizer functions for converting threshold
	_capture - Stores a region that the regionBox is overlapping, then proceeds to recognize lines
				in that area
	_recognize - Finds lines in the area capture by _capture(), then proceeds to send the final, JSON parsed
				data to outputData
	outputData - Parses the JSON data from _recognize() further and sends it out using outputAutoRecData trigger
	
	</pre></p>

<h4>CanvasImage</h4>
<p><pre>Usage: <br/>
	Usage:
		new CanvasImage({loc:{jQuery Object}})
	
	</pre></p>
<p><pre>
	zoomHandle(e {Event}, v {Integer}) - Called by 'zoom' event. Adjust scale by v.<br/>
	setUpCanvas(url {String}) - sets the HTML5 Canvas to the given url.<br/>
	_closeOut - hides the container DOM<br/>
	_restart - shows the container DOM and calls setUpCanvas for current url<br/>
	_resetCanvasImage - re-draws the HTML5 Canvas<br/>
	_getPerc - outputs percentage offsets of Canvas image area. Returns {Object} {l (left),t (top),w (width),h (height)} <br/>
	
	</pre></p>

<h4>RegionBox</h4>
<p><pre>Usage: <br/>
	new RegionBox({loc:{Object}})
	loc: DOM Object to attach RegionBox to 
	
	</pre></p>
<p><pre>
	_flash - Flashes the DOM container on and off<br/>
	_zoomHandle(e {Event}, v {Integer}) - Called by 'zoom' event. Scales Canvas image<br/>
							to 'v'
	_onoff(e {Event})
	_getDims - Returns Bounding Box Object ("left","top","width","height") for regionBox
	_adjustSize(scale {Integer}) - adjusts the Bounding Box to the integer @scale 
	_closeOut(e {Event}) - Hides the container DOM. Called by closeOutAutoRec trigger.
	
</pre></p>

<h4>Shape</h4>
<p>Houses a collection of dot coordinates taken from CanvasAutoRecognizer<br/>
<pre>Usage: <br/>
	new Shape({index: {Integer},initialTop: {Integer}, initialLeft: {Integer}, foundOnRow: {Integer}});
	
	index {Integer}: Index for this Shape <br/>
	initialTop {Integer} : The top coordinate value from the image<br/>
	initialLeft {Integer} : The left coordinate value from the image<br/>
	foundOnRow {Integer} : Index for the row found within the image (Relative to CanvasAutoRecognizer's array)
	</pre>
</p>	
	
	<p><pre>
		add(xy {Object}) - Add an xy value to the object's coords array. xy is an array such as : (x {Integer}, y {Integer}) 
		compare(shape {Object}, criteria {Object}) - Returns true or false, depending on whether the passed @shape Object<br/>
						has a similar [@criteria] parameter as the shape invoking the function.
	</pre></p>

<h4>ColorFilter</h4>
<p>Empty parent class for TileColorFilter</p>

<h4>TileColorFilter</h4>
<p><pre>Usage: <br/>
	new TileColorFilter({DOM: {String},red: {String}, green: {String}, blue: {String}, colorBox: {String}});
		DOM {String} : DOM id of container
		red {String} : DOM id of div for red slider
		green {String} : DOM id of div for greeen slider
		blue {String} :  DOM id of div for blue slider
		colorBox {String} : DOM id of div showing color
	
	</pre></p>
<p><pre>
	_restart - Resets the sliders back to default values and resets bound events to DOM objects<br/>
	setValue(rgb {String}) - Takes a string RGB value (Format: (r,g,b)) then sets sliders and rgbDiv to this value<br/>
	changeColorFromSlider(e {Event}, color {String}, val {Integer}) - Set a specific color to a certain value. Triggered<br/>
				by slideChange<br/>
	_RGB - Returns a {String} representing current (r,g,b) value
	
</pre></p>

<h4>RegionRule</h4>
<p>Object representing an array of values 
	related to a region of an image to recognize<pre></pre></p>
<p><pre>
  args:
 move: Enum type [stay|next|prev] which directs whether to change the page
 top: % from top of image
 left: % from left of image
 height: % from height of image
 width: % from width of image
 </pre></p>

<h4>lineBox</h4>
<p>DOM container box that represents a recognized line within an image.
	<pre>
		Usage: <br/>
		new lineBox({width:{Integer},height:{Integer},left:{Integer},top:{Integer}});
	</pre></p>
<p><pre>
	select(id {String}) - Selects this linebox - or whichever is matched by ID. Box <br/>
			then becomes draggable and resizeable.
	zoomHandle(e {Event}, v {Integer}) - Handles 'zoom' event. Scales the box to the passed<br/>
		'v' value.
	
</pre></p>

<h4>AutoRecognizer</h4>
<p>**Parent Class for CanvasAutoRecognizer<pre></pre></p>
<p><pre>Properties: <br/>
	data {Array}
	shapes {Array}
	</pre></p>

<h4>CanvasAutoRecognizer</h4>
<p><pre>Usage: 
new CanvasAutoRecognizer({regionID:{String},dotMin:{Integer},dotMax:{Integer}});</pre></p>
<p><pre>
	thresholdConversion(threshold {Integer}) - Starts converting the image into black and white. Creates<br/>
			dotMatrix object. 
	medianThreshold - Takes the dotMatrix object and sorts the dots into black or white
	filterDots - Filters the dots further into black or white dots
	paintFromDotMatrix(matrix {Object}) - takes array of dots (matrix) and uses this as a guide to <br/>
							change each pixel in an image to either black or white
	convertShapesToLines
	cleanLineBreaks
	colorLineBreaks
	
	
</pre></p>

<h4>AR</h4>
<p>Object that is fed into the TILE_ENGINE as a plugin.<pre>
	**This object does not have a constructor, it is pre-defined.
	
	Properties:
	constructed: {Boolean} - whether or not start() has already been called; if true, use restart() instead of start()
	name: {String} - name to be used as key in the toolSet array in TILE_ENGINE
	done: {String} - name representing the Event which will trigger TILE_ENGINE to close this object down
	outputData: {String} - name representing the Event which TILE_ENGINE will use to receive output data
</pre></p>
<p><pre>
	Functions: 
	start(id:{String},data:{Object}) - Calls the TileOCR constructor. Uses id as string of the unique id of the parent DOM, and takes
	 								JSON data object for loading transcript lines.
	restart(json {Object}) - Called once tool has already been constructed. Calls TileOCR _restart function and feeds it transcript lines, 
	 					located in passed 'json' object
	close - Called by TILE_ENGINE to close down this tool - to reactivate, the restart() function is called
	bundleData(j {Object}) - TILE_ENGINE passes object 'j' to be added onto. TileOCR adds on relevant data to this object. 
</pre></p>

</body>
</html>